<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Idle Miner</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(to bottom, #87CEEB 0%, #87CEEB 20%, #8B4513 20%, #8B4513 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow: hidden;
        }

        .game-header {
            width: 100%;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 15px;
            text-align: center;
            z-index: 100;
        }

        .coal-counter {
            font-size: 24px;
            font-weight: bold;
        }

        .coal-icon {
            display: inline-block;
            width: 20px;
            height: 20px;
            background: #2c2c2c;
            border-radius: 3px;
            margin-right: 8px;
            vertical-align: middle;
        }

        .game-container {
            position: relative;
            width: 400px;
            height: 600px;
            margin-top: 20px;
        }

        /* Surface area */
        .surface {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 80px;
            background: linear-gradient(to bottom, #228B22 0%, #228B22 60%, #8B4513 100%);
            border-bottom: 4px solid #654321;
            z-index: 10;
        }

        .surface-building {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 50px;
            background: #8B0000;
            border: 3px solid #5c0000;
        }

        .surface-building::before {
            content: '';
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            border-left: 45px solid transparent;
            border-right: 45px solid transparent;
            border-bottom: 25px solid #5c0000;
        }

        /* Elevator shaft */
        .elevator-shaft {
            position: absolute;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 520px;
            background: #3a3a3a;
            border-left: 4px solid #555;
            border-right: 4px solid #555;
        }

        .elevator-track {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 100%;
            background: #666;
        }

        .elevator {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 40px;
            background: linear-gradient(to bottom, #ffd700, #daa520);
            border: 3px solid #b8860b;
            border-radius: 5px;
            transition: top 0.5s ease-in-out;
            z-index: 5;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .elevator.moving {
            transition: top 2s linear;
        }

        /* Mineshaft level */
        .mineshaft {
            position: absolute;
            top: 450px;
            left: 0;
            width: 100%;
            height: 100px;
            background: #2a2a2a;
            border-top: 4px solid #444;
            border-bottom: 4px solid #444;
        }

        .mineshaft-floor {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 20px;
            background: #4a4a4a;
        }

        /* Mining tunnel */
        .mining-tunnel {
            position: absolute;
            top: 20px;
            right: 0;
            width: 120px;
            height: 60px;
            background: #1a1a1a;
            border-left: 4px solid #333;
        }

        .coal-deposit {
            position: absolute;
            top: 50%;
            right: 10px;
            transform: translateY(-50%);
            width: 40px;
            height: 40px;
            background: radial-gradient(circle, #3a3a3a 0%, #1a1a1a 100%);
            border-radius: 5px;
            display: flex;
            flex-wrap: wrap;
            padding: 5px;
            gap: 3px;
        }

        .coal-piece {
            width: 12px;
            height: 12px;
            background: #2c2c2c;
            border-radius: 2px;
            box-shadow: inset -2px -2px 4px rgba(0,0,0,0.5), inset 2px 2px 4px rgba(100,100,100,0.3);
        }

        /* Worker */
        .worker {
            position: absolute;
            width: 30px;
            height: 40px;
            cursor: pointer;
            z-index: 20;
            transition: left 1s linear, top 0.3s ease;
        }

        .worker:hover {
            transform: scale(1.1);
        }

        .worker-body {
            position: relative;
            width: 100%;
            height: 100%;
        }

        .worker-head {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 16px;
            height: 16px;
            background: #ffdbac;
            border-radius: 50%;
        }

        .worker-helmet {
            position: absolute;
            top: -3px;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 12px;
            background: #ffd700;
            border-radius: 10px 10px 0 0;
        }

        .worker-helmet-light {
            position: absolute;
            top: 2px;
            left: 50%;
            transform: translateX(-50%);
            width: 6px;
            height: 6px;
            background: #fff;
            border-radius: 50%;
            box-shadow: 0 0 5px #fff, 0 0 10px #ffd700;
        }

        .worker-torso {
            position: absolute;
            top: 15px;
            left: 50%;
            transform: translateX(-50%);
            width: 18px;
            height: 15px;
            background: #4169E1;
            border-radius: 3px;
        }

        .worker-legs {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 16px;
            height: 12px;
            background: #2F4F4F;
            border-radius: 0 0 3px 3px;
        }

        .worker.walking {
            animation: walk 0.3s infinite;
        }

        @keyframes walk {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-3px); }
        }

        .worker.mining {
            animation: mine 0.4s infinite;
        }

        @keyframes mine {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(-15deg); }
        }

        /* Carried coal indicator */
        .carried-coal {
            position: absolute;
            top: 10px;
            right: -10px;
            width: 15px;
            height: 15px;
            background: #2c2c2c;
            border-radius: 3px;
            display: none;
            box-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }

        .worker.has-coal .carried-coal {
            display: block;
        }

        /* Status text */
        .worker-status {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            white-space: nowrap;
            font-size: 10px;
            color: white;
            background: rgba(0,0,0,0.7);
            padding: 2px 6px;
            border-radius: 3px;
        }

        /* Instructions */
        .instructions {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            text-align: center;
            z-index: 100;
        }

        .instructions h3 {
            margin-bottom: 5px;
            color: #ffd700;
        }

        /* Coal sparkle effect */
        .coal-sparkle {
            position: absolute;
            pointer-events: none;
            font-size: 20px;
            animation: sparkle 1s ease-out forwards;
            z-index: 100;
        }

        @keyframes sparkle {
            0% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(-50px); }
        }
    </style>
</head>
<body>
    <div class="game-header">
        <div class="coal-counter">
            <span class="coal-icon"></span>
            <span id="coalCount">0</span> Coal
        </div>
    </div>

    <div class="game-container">
        <!-- Surface -->
        <div class="surface">
            <div class="surface-building"></div>
        </div>

        <!-- Elevator Shaft -->
        <div class="elevator-shaft">
            <div class="elevator-track"></div>
            <div class="elevator" id="elevator"></div>
        </div>

        <!-- Mineshaft Level -->
        <div class="mineshaft">
            <div class="mineshaft-floor"></div>
            <div class="mining-tunnel">
                <div class="coal-deposit">
                    <div class="coal-piece"></div>
                    <div class="coal-piece"></div>
                    <div class="coal-piece"></div>
                    <div class="coal-piece"></div>
                </div>
            </div>
        </div>

        <!-- Worker -->
        <div class="worker" id="worker" onclick="handleWorkerClick()">
            <div class="worker-status" id="workerStatus">Click me!</div>
            <div class="worker-body">
                <div class="worker-helmet">
                    <div class="worker-helmet-light"></div>
                </div>
                <div class="worker-head"></div>
                <div class="worker-torso"></div>
                <div class="worker-legs"></div>
            </div>
            <div class="carried-coal"></div>
        </div>
    </div>

    <div class="instructions">
        <h3>Idle Miner</h3>
        <p>Click the worker to send them mining!</p>
    </div>

    <script>
        // Game state
        let coal = 0;
        let workerState = 'idle'; // idle, walking-to-mine, mining, walking-to-elevator, riding-up, walking-to-deposit, depositing, riding-down, walking-back

        // DOM elements
        const worker = document.getElementById('worker');
        const elevator = document.getElementById('elevator');
        const workerStatus = document.getElementById('workerStatus');
        const coalCountEl = document.getElementById('coalCount');

        // Positions
        const positions = {
            idle: { left: 155, top: 480 },           // Near elevator at mineshaft level
            mineEntrance: { left: 230, top: 480 },   // At mine tunnel entrance
            mining: { left: 320, top: 480 },         // At coal deposit
            elevator: { left: 175, top: 480 },       // On elevator at bottom
            elevatorTop: { left: 175, top: 55 },     // On elevator at top (surface)
            deposit: { left: 155, top: 55 }          // At deposit point on surface
        };

        const elevatorPositions = {
            bottom: 430,  // Bottom of shaft
            top: 0        // Top of shaft (surface)
        };

        // Initialize worker position
        worker.style.left = positions.idle.left + 'px';
        worker.style.top = positions.idle.top + 'px';
        elevator.style.top = elevatorPositions.bottom + 'px';

        function updateStatus(text) {
            workerStatus.textContent = text;
        }

        function setWorkerPosition(pos, duration = 1000) {
            return new Promise(resolve => {
                worker.style.transition = `left ${duration}ms linear, top ${duration}ms ease`;
                worker.style.left = pos.left + 'px';
                worker.style.top = pos.top + 'px';
                setTimeout(resolve, duration);
            });
        }

        function setElevatorPosition(pos, duration = 2000) {
            return new Promise(resolve => {
                elevator.classList.add('moving');
                elevator.style.top = pos + 'px';
                setTimeout(() => {
                    elevator.classList.remove('moving');
                    resolve();
                }, duration);
            });
        }

        function addCoal() {
            coal++;
            coalCountEl.textContent = coal;

            // Create sparkle effect
            const sparkle = document.createElement('div');
            sparkle.className = 'coal-sparkle';
            sparkle.textContent = '+1';
            sparkle.style.left = positions.deposit.left + 'px';
            sparkle.style.top = positions.deposit.top + 'px';
            document.querySelector('.game-container').appendChild(sparkle);

            setTimeout(() => sparkle.remove(), 1000);
        }

        async function handleWorkerClick() {
            if (workerState !== 'idle') return;

            // Start mining sequence
            workerState = 'busy';

            // 1. Walk to mine
            updateStatus('Walking...');
            worker.classList.add('walking');
            await setWorkerPosition(positions.mineEntrance, 800);
            await setWorkerPosition(positions.mining, 800);
            worker.classList.remove('walking');

            // 2. Mine coal
            updateStatus('Mining...');
            worker.classList.add('mining');
            await new Promise(r => setTimeout(r, 2000));
            worker.classList.remove('mining');
            worker.classList.add('has-coal');

            // 3. Walk back to elevator
            updateStatus('Got coal!');
            worker.classList.add('walking');
            await setWorkerPosition(positions.mineEntrance, 800);
            await setWorkerPosition(positions.elevator, 600);
            worker.classList.remove('walking');

            // 4. Ride elevator up
            updateStatus('Going up...');
            // Move worker with elevator
            const rideUp = async () => {
                const duration = 2000;
                const startTop = positions.elevator.top;
                const endTop = positions.elevatorTop.top;
                const startTime = Date.now();

                const animate = () => {
                    const elapsed = Date.now() - startTime;
                    const progress = Math.min(elapsed / duration, 1);
                    const currentTop = startTop + (endTop - startTop) * progress;
                    worker.style.top = currentTop + 'px';

                    if (progress < 1) {
                        requestAnimationFrame(animate);
                    }
                };

                animate();
                await setElevatorPosition(elevatorPositions.top, duration);
            };
            await rideUp();

            // 5. Walk to deposit
            updateStatus('Depositing...');
            worker.classList.add('walking');
            await setWorkerPosition(positions.deposit, 500);
            worker.classList.remove('walking');

            // 6. Deposit coal
            await new Promise(r => setTimeout(r, 500));
            worker.classList.remove('has-coal');
            addCoal();

            // 7. Walk back to elevator
            worker.classList.add('walking');
            await setWorkerPosition({ left: 175, top: 55 }, 500);
            worker.classList.remove('walking');

            // 8. Ride elevator down
            updateStatus('Going down...');
            const rideDown = async () => {
                const duration = 2000;
                const startTop = positions.elevatorTop.top;
                const endTop = positions.elevator.top;
                const startTime = Date.now();

                const animate = () => {
                    const elapsed = Date.now() - startTime;
                    const progress = Math.min(elapsed / duration, 1);
                    const currentTop = startTop + (endTop - startTop) * progress;
                    worker.style.top = currentTop + 'px';

                    if (progress < 1) {
                        requestAnimationFrame(animate);
                    }
                };

                animate();
                await setElevatorPosition(elevatorPositions.bottom, duration);
            };
            await rideDown();

            // 9. Return to idle position
            worker.classList.add('walking');
            await setWorkerPosition(positions.idle, 300);
            worker.classList.remove('walking');

            updateStatus('Click me!');
            workerState = 'idle';
        }
    </script>
</body>
</html>
